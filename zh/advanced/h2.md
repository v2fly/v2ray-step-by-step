# HTTP/2  

簡單地說 HTTP/2 是 HTTP/1.1 的升級版（目前大多數網頁還是 HTTP/1.1），點擊[這裏](https://http2.akamai.com/demo)可以直觀地體會到 HTTP/2 相比於 HTTP/1.1 的提升（不代表 V2Ray 中 HTTP/2 相對於 TCP 的提升就是這樣的）。HTTP/2協議一般簡稱爲h2。

在 v2ray 中使用 h2，經常被用戶們用來跟 websocket 方式做比較。從理論上來說，HTTP/2 在首次連接時，不像 websocket 需完成 upgrade 請求；v2ray 客戶端和服務端之間一般直接通信，較少中間層代理。但是，在配合 CDN、Nginx/Caddy/Apache 等服務組件作爲前置分流代理的應用場景上，h2 沒有 websocket 方式靈活，因爲很多代理並不提供 h2 協議的後端支持。實際使用中，websocket 和 h2 的方式，在體驗上很可能沒有明顯區別，用戶可自行根據需要選擇。

## 配置

與其它的傳輸層協議一樣在 streamSettings 中配置，不過要注意的是使用 HTTP/2 要開啓 TLS。

### 服務器配置
```json
{
  "inbounds": [
    {
      "port": 443,
      "protocol": "vmess",
      "settings": {
        "clients": [
          {
            "id": "b831381d-6324-4d53-ad4f-8cda48b30811",
            "alterId": 64
          }
        ]
      },
      "streamSettings": {
        "network": "h2", // h2 也可寫成 http，效果一樣
        "httpSettings": { //此項是關於 HTTP/2 的設置
          "path": "/ray"
        },
        "security": "tls", // 配置tls
        "tlsSettings": {
          "certificates": [
            {
              "certificateFile": "/etc/v2ray/v2ray.crt", // 證書文件，詳見 tls 小節
              "keyFile": "/etc/v2ray/v2ray.key" // 密鑰文件
            }
          ]
        }
      }
    }
  ],
  "outbounds": [
    {
      "protocol": "freedom",
      "settings": {}
    }
  ]
}
```


### 客戶端配置

```json
{
  "inbounds": [
    {
      "port": 1080,
      "listen": "127.0.0.1",
      "protocol": "socks",
      "sniffing": {
        "enabled": true,
        "destOverride": ["http", "tls"]
      },
      "settings": {
        "auth": "noauth",
        "udp": false
      }
    }
  ],
  "outbounds": [
    {
      "protocol": "vmess",
      "settings": {
        "vnext": [
          {
            "address": "mydomain.me",
            "port": 443,
            "users": [
              {
                "id": "b831381d-6324-4d53-ad4f-8cda48b30811",
                "alterId": 64
              }
            ]
          }
        ]
      },
      "streamSettings": {
        "network": "h2",
        "httpSettings": { //此項是關於 HTTP/2 的設置
          "path": "/ray"
        },
        "security": "tls"
      }
    }
  ]
}
```

#### 更新歷史

- 2018-03-18 初版
- 2018-08-30 Update
- 2018-11-17 V4.0+ 配置
- 2019-07-11 更新h2描述
